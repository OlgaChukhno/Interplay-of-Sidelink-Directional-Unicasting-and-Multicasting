%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                       simulates number of node                          %
%                                                                         %
%              author - Olga Chukhno <olga.chukhno@unirc.it>              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all
close all

%% initial parameters 
%a,b, and c are the weight parameters used to perform resource splitting among transmission modes
a=0.01; %unicast
b=0.8; %multicast
c=0.19; %sidelink

% mu_x is the transition rate from served users to waiting users (in 1/s)
mu_x=0.0;

%C_u, C_m, and C_d represnt unicast, multicast, and sidelink capacities (in Mbits)
C_u=551.46; 
C_m=653.7;
C_d=78.05;

% B is the content/packet size, (in Mbit)
B=640;

% theta_x, theta_y, theta_z are departure rate of waiting users, served users, and search & rescue operators (in 1/s)
theta_x=0.0000001;
theta_y=0.0000001;
theta_z=0.1;

% Arrival rate of search & rescue operators(in 1/s)
lambda=5.5;

% N_x and N_y are the number of waiting and served users at t=0
N_x=30;
N_y=0;

% Switches and basic parameters
min_index=51;
t=0:0.01:min_index-1;

%% Validation (V)
run=false;

if(run)
    syms x(t) y(t) z(t) a b c mu_x C_u C_m C_d B theta_x theta_y theta_z lambda N_x N_y
    ode1 = diff(x) == y*mu_x - a*C_u/B - b*(C_m/B)*x - c* (C_d*z)/B- x*theta_x;
    ode2 = diff(y) == a*C_u/B + b*(C_m/B)*x + c* (C_d*z)/B - y*theta_y -y*mu_x;
    ode3 = diff(z) == lambda- z*theta_z;

    odes = [ode1; ode2; ode3 ]

    S = dsolve(odes)

    xSol(t) = S.x
    ySol(t) = S.y
    zSol(t) = S.z

    [xSol(t), ySol(t), zSol(t)] = dsolve(odes)

    cond1 = x(0) ==  N_x;
    cond2 = y(0) == N_y;
    cond3 = z(0) == 0;

    conds = [cond1; cond2; cond3];
    [xSol(t), ySol(t), zSol(t)] = dsolve(odes,conds)
    % 

    x=simplify(xSol(t));
    y=simplify(ySol(t));
    z=simplify(zSol(t));
else
    x=(real((exp(-(t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*((2.*C_m.^3.*N_x.*b.^3.*theta_y - 2.*C_m.^3.*N_x.*b.^3.*theta_z - 2.*B.^3.*N_y.*mu_x.^3.*theta_x + 2.*B.^3.*N_y.*mu_x.^3.*theta_z - 2.*B.^3.*N_y.*theta_x.*theta_y.^3 + 2.*B.^3.*N_y.*theta_y.^3.*theta_z + 2.*B.^3.*N_y.*mu_x.^2.*theta_x.^2 - 2.*B.^3.*N_y.*mu_x.^2.*theta_z.^2 + 2.*B.^3.*N_y.*theta_x.^2.*theta_y.^2 - 2.*B.^3.*N_y.*theta_y.^2.*theta_z.^2 - 6.*B.^3.*N_y.*mu_x.*theta_x.*theta_y.^2 + 4.*B.^3.*N_y.*mu_x.*theta_x.^2.*theta_y - 6.*B.^3.*N_y.*mu_x.^2.*theta_x.*theta_y + 2.*B.^3.*N_y.*mu_x.*theta_x.*theta_z.^2 - 2.*B.^3.*N_y.*mu_x.*theta_x.^2.*theta_z - 4.*B.^3.*N_y.*mu_x.*theta_y.*theta_z.^2 + 6.*B.^3.*N_y.*mu_x.*theta_y.^2.*theta_z + 6.*B.^3.*N_y.*mu_x.^2.*theta_y.*theta_z + 2.*B.^3.*N_y.*theta_x.*theta_y.*theta_z.^2 - 2.*B.^3.*N_y.*theta_x.^2.*theta_y.*theta_z + 2.*B.*C_m.^2.*N_x.*b.^2.*theta_y.^2 + 2.*B.*C_m.^2.*N_x.*b.^2.*theta_z.^2 + 2.*B.*C_m.^2.*N_y.*b.^2.*theta_y.^2 - 2.*C_m.^2.*N_x.*b.^2.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*C_m.^2.*N_x.*b.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*mu_x.^2.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*mu_x.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*mu_x.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*theta_x.*theta_y.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*theta_y.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*theta_y.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_m.*N_y.*b.*theta_y.^3 + 2.*C_m.^2.*C_u.*a.*b.^2.*theta_y - 2.*C_m.^2.*C_u.*a.*b.^2.*theta_z - 2.*B.^2.*C_u.*a.*mu_x.*theta_x.^2 + 2.*B.^2.*C_u.*a.*mu_x.^2.*theta_x + 2.*B.^2.*C_u.*a.*mu_x.*theta_z.^2 - 2.*B.^2.*C_u.*a.*mu_x.^2.*theta_z + 2.*B.^2.*C_d.*c.*lambda.*theta_x.^2 - 2.*B.*C_u.*a.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*C_u.*a.*theta_x.*theta_y.^2 - 2.*B.^2.*C_u.*a.*theta_x.^2.*theta_y - 2.*B.^2.*C_u.*a.*theta_x.*theta_z.^2 + 2.*B.^2.*C_u.*a.*theta_x.^2.*theta_z + 2.*B.^2.*C_u.*a.*theta_y.*theta_z.^2 - 2.*B.^2.*C_u.*a.*theta_y.^2.*theta_z - 2.*B.*C_u.*a.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_u.*a.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_u.*a.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_x + 2.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.^2 + 2.*B.^2.*C_m.*N_x.*b.*mu_x.^2.*theta_x + 2.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_y - 4.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*mu_x.^2.*theta_z - 2.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_x - 2.*B.*C_m.^2.*N_y.*b.^2.*mu_x.*theta_y - 4.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_y.^2 - 2.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_y + 2.*B.*C_m.^2.*N_y.*b.^2.*mu_x.*theta_z - 2.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_z.^2 + 4.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_z - 2.*B.*C_m.*N_x.*b.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_y.*b.*theta_y.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.*C_m.^2.*N_x.*b.^2.*theta_x.*theta_y + 2.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_y.^2 + 2.*B.^2.*C_m.*N_x.*b.*theta_x.^2.*theta_y - 4.*B.*C_m.^2.*N_x.*b.^2.*theta_x.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*theta_x.^2.*theta_z - 4.*B.*C_m.^2.*N_x.*b.^2.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*theta_y.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*theta_y.^2.*theta_z + 4.*B.^2.*C_m.*N_y.*b.*theta_x.*theta_y.^2 - 2.*B.*C_m.^2.*N_y.*b.^2.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_y.*b.*theta_y.*theta_z.^2 + 4.*B.^2.*N_y.*mu_x.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*mu_x.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 4.*B.^2.*N_y.*mu_x.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*theta_x.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*C_u.*a.*b.*theta_y.^2 + 2.*B.*C_m.*C_u.*a.*b.*theta_z.^2 - 2.*C_m.*C_u.*a.*b.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*C_m.*C_u.*a.*b.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_d.*c.*lambda.*mu_x.*theta_x + 2.*B.^2.*C_d.*c.*lambda.*mu_x.*theta_z - 2.*B.*C_u.*a.*mu_x.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_u.*a.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*C_u.*a.*mu_x.*theta_x.*theta_y - 4.*B.^2.*C_u.*a.*mu_x.*theta_y.*theta_z + 2.*B.*C_d.*c.*lambda.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_d.*c.*lambda.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_d.*c.*lambda.*theta_x.*theta_y - 2.*B.^2.*C_d.*c.*lambda.*theta_x.*theta_z + 2.*B.^2.*C_d.*c.*lambda.*theta_y.*theta_z - 2.*B.*C_m.*N_x.*b.*mu_x.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_x.*b.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_y.*b.*mu_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_y.*b.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.*theta_y - 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.*theta_z - 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_x.*theta_y + 4.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_y.*theta_z - 2.*B.*C_m.*N_x.*b.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_x.*b.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_x.*b.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_y.*b.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 4.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_y.*theta_z - 4.*B.^2.*C_m.*N_y.*b.*theta_x.*theta_y.*theta_z + 2.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_x + 2.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_y - 4.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_z + 2.*B.*C_d.*C_m.*b.*c.*lambda.*theta_x - 4.*B.*C_d.*C_m.*b.*c.*lambda.*theta_y + 2.*B.*C_d.*C_m.*b.*c.*lambda.*theta_z - 4.*B.*C_m.*C_u.*a.*b.*theta_y.*theta_z)./(2.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)).*(B.*theta_z.^2 + C_m.*b.*theta_y - C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)) - ((2.*B.*exp((t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*(C_u.*a.*B.^2.*mu_x.^2.*theta_x - C_u.*a.*B.^2.*mu_x.^2.*theta_z - C_u.*a.*B.^2.*mu_x.*theta_x.^2 + 2.*C_u.*a.*B.^2.*mu_x.*theta_x.*theta_y - C_d.*c.*lambda.*B.^2.*mu_x.*theta_x - 2.*C_u.*a.*B.^2.*mu_x.*theta_y.*theta_z + C_u.*a.*B.^2.*mu_x.*theta_z.^2 + C_d.*c.*lambda.*B.^2.*mu_x.*theta_z - C_u.*a.*B.^2.*theta_x.^2.*theta_y + C_u.*a.*B.^2.*theta_x.^2.*theta_z + C_d.*c.*lambda.*B.^2.*theta_x.^2 + C_u.*a.*B.^2.*theta_x.*theta_y.^2 - C_d.*c.*lambda.*B.^2.*theta_x.*theta_y - C_u.*a.*B.^2.*theta_x.*theta_z.^2 - C_d.*c.*lambda.*B.^2.*theta_x.*theta_z - C_u.*a.*B.^2.*theta_y.^2.*theta_z + C_u.*a.*B.^2.*theta_y.*theta_z.^2 + C_d.*c.*lambda.*B.^2.*theta_y.*theta_z + C_u.*a.*B.*C_m.*b.*mu_x.*theta_x + C_u.*a.*B.*C_m.*b.*mu_x.*theta_y - 2.*C_u.*a.*B.*C_m.*b.*mu_x.*theta_z + C_d.*c.*lambda.*B.*C_m.*b.*theta_x + C_u.*a.*B.*C_m.*b.*theta_y.^2 - 2.*C_u.*a.*B.*C_m.*b.*theta_y.*theta_z - 2.*C_d.*c.*lambda.*B.*C_m.*b.*theta_y + C_u.*a.*B.*C_m.*b.*theta_z.^2 + C_d.*c.*lambda.*B.*C_m.*b.*theta_z + C_u.*a.*C_m.^2.*b.^2.*theta_y - C_u.*a.*C_m.^2.*b.^2.*theta_z) - 2.*B.*exp((t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2).*(B.*C_u.*a.*theta_z.^2 + C_m.*C_u.*a.*b.*theta_y - C_m.*C_u.*a.*b.*theta_z + B.*C_u.*a.*mu_x.*theta_x - B.*C_u.*a.*mu_x.*theta_z - B.*C_d.*c.*lambda.*theta_x + B.*C_d.*c.*lambda.*theta_z + B.*C_u.*a.*theta_x.*theta_y - B.*C_u.*a.*theta_x.*theta_z - B.*C_u.*a.*theta_y.*theta_z)).*(B.*theta_z.^2 - C_m.*b.*theta_y + C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z))./(2.*B.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2).*(B.^2.*mu_x.^2.*theta_x.^2 - 2.*B.^2.*mu_x.^2.*theta_x.*theta_z + B.^2.*mu_x.^2.*theta_z.^2 + 2.*B.^2.*mu_x.*theta_x.^2.*theta_y - 2.*B.^2.*mu_x.*theta_x.^2.*theta_z - 4.*B.^2.*mu_x.*theta_x.*theta_y.*theta_z + 4.*B.^2.*mu_x.*theta_x.*theta_z.^2 + 2.*B.^2.*mu_x.*theta_y.*theta_z.^2 - 2.*B.^2.*mu_x.*theta_z.^3 + B.^2.*theta_x.^2.*theta_y.^2 - 2.*B.^2.*theta_x.^2.*theta_y.*theta_z + B.^2.*theta_x.^2.*theta_z.^2 - 2.*B.^2.*theta_x.*theta_y.^2.*theta_z + 4.*B.^2.*theta_x.*theta_y.*theta_z.^2 - 2.*B.^2.*theta_x.*theta_z.^3 + B.^2.*theta_y.^2.*theta_z.^2 - 2.*B.^2.*theta_y.*theta_z.^3 + B.^2.*theta_z.^4 - C_m.^2.*b.^2.*theta_y.^2 + 2.*C_m.^2.*b.^2.*theta_y.*theta_z - C_m.^2.*b.^2.*theta_z.^2))).*(B.*mu_x - C_m.*b - B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*C_m.*b) + (exp(-(t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*((2.*C_m.^3.*N_x.*b.^3.*theta_y - 2.*C_m.^3.*N_x.*b.^3.*theta_z - 2.*B.^3.*N_y.*mu_x.^3.*theta_x + 2.*B.^3.*N_y.*mu_x.^3.*theta_z - 2.*B.^3.*N_y.*theta_x.*theta_y.^3 + 2.*B.^3.*N_y.*theta_y.^3.*theta_z + 2.*B.^3.*N_y.*mu_x.^2.*theta_x.^2 - 2.*B.^3.*N_y.*mu_x.^2.*theta_z.^2 + 2.*B.^3.*N_y.*theta_x.^2.*theta_y.^2 - 2.*B.^3.*N_y.*theta_y.^2.*theta_z.^2 - 6.*B.^3.*N_y.*mu_x.*theta_x.*theta_y.^2 + 4.*B.^3.*N_y.*mu_x.*theta_x.^2.*theta_y - 6.*B.^3.*N_y.*mu_x.^2.*theta_x.*theta_y + 2.*B.^3.*N_y.*mu_x.*theta_x.*theta_z.^2 - 2.*B.^3.*N_y.*mu_x.*theta_x.^2.*theta_z - 4.*B.^3.*N_y.*mu_x.*theta_y.*theta_z.^2 + 6.*B.^3.*N_y.*mu_x.*theta_y.^2.*theta_z + 6.*B.^3.*N_y.*mu_x.^2.*theta_y.*theta_z + 2.*B.^3.*N_y.*theta_x.*theta_y.*theta_z.^2 - 2.*B.^3.*N_y.*theta_x.^2.*theta_y.*theta_z + 2.*B.*C_m.^2.*N_x.*b.^2.*theta_y.^2 + 2.*B.*C_m.^2.*N_x.*b.^2.*theta_z.^2 + 2.*B.*C_m.^2.*N_y.*b.^2.*theta_y.^2 + 2.*C_m.^2.*N_x.*b.^2.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*C_m.^2.*N_x.*b.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*mu_x.^2.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*mu_x.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*mu_x.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*theta_x.*theta_y.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*theta_y.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*theta_y.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_m.*N_y.*b.*theta_y.^3 + 2.*C_m.^2.*C_u.*a.*b.^2.*theta_y - 2.*C_m.^2.*C_u.*a.*b.^2.*theta_z - 2.*B.^2.*C_u.*a.*mu_x.*theta_x.^2 + 2.*B.^2.*C_u.*a.*mu_x.^2.*theta_x + 2.*B.^2.*C_u.*a.*mu_x.*theta_z.^2 - 2.*B.^2.*C_u.*a.*mu_x.^2.*theta_z + 2.*B.^2.*C_d.*c.*lambda.*theta_x.^2 + 2.*B.*C_u.*a.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*C_u.*a.*theta_x.*theta_y.^2 - 2.*B.^2.*C_u.*a.*theta_x.^2.*theta_y - 2.*B.^2.*C_u.*a.*theta_x.*theta_z.^2 + 2.*B.^2.*C_u.*a.*theta_x.^2.*theta_z + 2.*B.^2.*C_u.*a.*theta_y.*theta_z.^2 - 2.*B.^2.*C_u.*a.*theta_y.^2.*theta_z + 2.*B.*C_u.*a.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_u.*a.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_u.*a.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_x + 2.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.^2 + 2.*B.^2.*C_m.*N_x.*b.*mu_x.^2.*theta_x + 2.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_y - 4.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*mu_x.^2.*theta_z - 2.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_x - 2.*B.*C_m.^2.*N_y.*b.^2.*mu_x.*theta_y - 4.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_y.^2 - 2.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_y + 2.*B.*C_m.^2.*N_y.*b.^2.*mu_x.*theta_z - 2.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_z.^2 + 4.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_z + 2.*B.*C_m.*N_x.*b.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_y.*b.*theta_y.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.*C_m.^2.*N_x.*b.^2.*theta_x.*theta_y + 2.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_y.^2 + 2.*B.^2.*C_m.*N_x.*b.*theta_x.^2.*theta_y - 4.*B.*C_m.^2.*N_x.*b.^2.*theta_x.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*theta_x.^2.*theta_z - 4.*B.*C_m.^2.*N_x.*b.^2.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*theta_y.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*theta_y.^2.*theta_z + 4.*B.^2.*C_m.*N_y.*b.*theta_x.*theta_y.^2 - 2.*B.*C_m.^2.*N_y.*b.^2.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_y.*b.*theta_y.*theta_z.^2 - 4.*B.^2.*N_y.*mu_x.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*mu_x.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*N_y.*mu_x.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*theta_x.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*C_u.*a.*b.*theta_y.^2 + 2.*B.*C_m.*C_u.*a.*b.*theta_z.^2 + 2.*C_m.*C_u.*a.*b.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*C_m.*C_u.*a.*b.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_d.*c.*lambda.*mu_x.*theta_x + 2.*B.^2.*C_d.*c.*lambda.*mu_x.*theta_z + 2.*B.*C_u.*a.*mu_x.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_u.*a.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*C_u.*a.*mu_x.*theta_x.*theta_y - 4.*B.^2.*C_u.*a.*mu_x.*theta_y.*theta_z - 2.*B.*C_d.*c.*lambda.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_d.*c.*lambda.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_d.*c.*lambda.*theta_x.*theta_y - 2.*B.^2.*C_d.*c.*lambda.*theta_x.*theta_z + 2.*B.^2.*C_d.*c.*lambda.*theta_y.*theta_z + 2.*B.*C_m.*N_x.*b.*mu_x.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_x.*b.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_y.*b.*mu_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_y.*b.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.*theta_y - 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.*theta_z - 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_x.*theta_y + 4.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_y.*theta_z + 2.*B.*C_m.*N_x.*b.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_x.*b.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_x.*b.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_y.*b.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 4.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_y.*theta_z - 4.*B.^2.*C_m.*N_y.*b.*theta_x.*theta_y.*theta_z + 2.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_x + 2.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_y - 4.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_z + 2.*B.*C_d.*C_m.*b.*c.*lambda.*theta_x - 4.*B.*C_d.*C_m.*b.*c.*lambda.*theta_y + 2.*B.*C_d.*C_m.*b.*c.*lambda.*theta_z - 4.*B.*C_m.*C_u.*a.*b.*theta_y.*theta_z)./(2.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)).*(B.*theta_z.^2 + C_m.*b.*theta_y - C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)) - ((2.*B.*exp((t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*(C_u.*a.*B.^2.*mu_x.^2.*theta_x - C_u.*a.*B.^2.*mu_x.^2.*theta_z - C_u.*a.*B.^2.*mu_x.*theta_x.^2 + 2.*C_u.*a.*B.^2.*mu_x.*theta_x.*theta_y - C_d.*c.*lambda.*B.^2.*mu_x.*theta_x - 2.*C_u.*a.*B.^2.*mu_x.*theta_y.*theta_z + C_u.*a.*B.^2.*mu_x.*theta_z.^2 + C_d.*c.*lambda.*B.^2.*mu_x.*theta_z - C_u.*a.*B.^2.*theta_x.^2.*theta_y + C_u.*a.*B.^2.*theta_x.^2.*theta_z + C_d.*c.*lambda.*B.^2.*theta_x.^2 + C_u.*a.*B.^2.*theta_x.*theta_y.^2 - C_d.*c.*lambda.*B.^2.*theta_x.*theta_y - C_u.*a.*B.^2.*theta_x.*theta_z.^2 - C_d.*c.*lambda.*B.^2.*theta_x.*theta_z - C_u.*a.*B.^2.*theta_y.^2.*theta_z + C_u.*a.*B.^2.*theta_y.*theta_z.^2 + C_d.*c.*lambda.*B.^2.*theta_y.*theta_z + C_u.*a.*B.*C_m.*b.*mu_x.*theta_x + C_u.*a.*B.*C_m.*b.*mu_x.*theta_y - 2.*C_u.*a.*B.*C_m.*b.*mu_x.*theta_z + C_d.*c.*lambda.*B.*C_m.*b.*theta_x + C_u.*a.*B.*C_m.*b.*theta_y.^2 - 2.*C_u.*a.*B.*C_m.*b.*theta_y.*theta_z - 2.*C_d.*c.*lambda.*B.*C_m.*b.*theta_y + C_u.*a.*B.*C_m.*b.*theta_z.^2 + C_d.*c.*lambda.*B.*C_m.*b.*theta_z + C_u.*a.*C_m.^2.*b.^2.*theta_y - C_u.*a.*C_m.^2.*b.^2.*theta_z) + 2.*B.*exp((t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2).*(B.*C_u.*a.*theta_z.^2 + C_m.*C_u.*a.*b.*theta_y - C_m.*C_u.*a.*b.*theta_z + B.*C_u.*a.*mu_x.*theta_x - B.*C_u.*a.*mu_x.*theta_z - B.*C_d.*c.*lambda.*theta_x + B.*C_d.*c.*lambda.*theta_z + B.*C_u.*a.*theta_x.*theta_y - B.*C_u.*a.*theta_x.*theta_z - B.*C_u.*a.*theta_y.*theta_z)).*(B.*theta_z.^2 - C_m.*b.*theta_y + C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z))./(2.*B.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2).*(B.^2.*mu_x.^2.*theta_x.^2 - 2.*B.^2.*mu_x.^2.*theta_x.*theta_z + B.^2.*mu_x.^2.*theta_z.^2 + 2.*B.^2.*mu_x.*theta_x.^2.*theta_y - 2.*B.^2.*mu_x.*theta_x.^2.*theta_z - 4.*B.^2.*mu_x.*theta_x.*theta_y.*theta_z + 4.*B.^2.*mu_x.*theta_x.*theta_z.^2 + 2.*B.^2.*mu_x.*theta_y.*theta_z.^2 - 2.*B.^2.*mu_x.*theta_z.^3 + B.^2.*theta_x.^2.*theta_y.^2 - 2.*B.^2.*theta_x.^2.*theta_y.*theta_z + B.^2.*theta_x.^2.*theta_z.^2 - 2.*B.^2.*theta_x.*theta_y.^2.*theta_z + 4.*B.^2.*theta_x.*theta_y.*theta_z.^2 - 2.*B.^2.*theta_x.*theta_z.^3 + B.^2.*theta_y.^2.*theta_z.^2 - 2.*B.^2.*theta_y.*theta_z.^3 + B.^2.*theta_z.^4 - C_m.^2.*b.^2.*theta_y.^2 + 2.*C_m.^2.*b.^2.*theta_y.*theta_z - C_m.^2.*b.^2.*theta_z.^2))).*(C_m.*b - B.*mu_x + B.*theta_x - B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*C_m.*b) - (C_d.*c.*lambda.*exp(-t.*theta_z).*(exp(t.*theta_z) - 1).*(theta_y - theta_z))./(theta_z.*(B.*theta_z.^2 + C_m.*b.*theta_y - C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z))));
    y=(real(exp(-(t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*((2.*C_m.^3.*N_x.*b.^3.*theta_y - 2.*C_m.^3.*N_x.*b.^3.*theta_z - 2.*B.^3.*N_y.*mu_x.^3.*theta_x + 2.*B.^3.*N_y.*mu_x.^3.*theta_z - 2.*B.^3.*N_y.*theta_x.*theta_y.^3 + 2.*B.^3.*N_y.*theta_y.^3.*theta_z + 2.*B.^3.*N_y.*mu_x.^2.*theta_x.^2 - 2.*B.^3.*N_y.*mu_x.^2.*theta_z.^2 + 2.*B.^3.*N_y.*theta_x.^2.*theta_y.^2 - 2.*B.^3.*N_y.*theta_y.^2.*theta_z.^2 - 6.*B.^3.*N_y.*mu_x.*theta_x.*theta_y.^2 + 4.*B.^3.*N_y.*mu_x.*theta_x.^2.*theta_y - 6.*B.^3.*N_y.*mu_x.^2.*theta_x.*theta_y + 2.*B.^3.*N_y.*mu_x.*theta_x.*theta_z.^2 - 2.*B.^3.*N_y.*mu_x.*theta_x.^2.*theta_z - 4.*B.^3.*N_y.*mu_x.*theta_y.*theta_z.^2 + 6.*B.^3.*N_y.*mu_x.*theta_y.^2.*theta_z + 6.*B.^3.*N_y.*mu_x.^2.*theta_y.*theta_z + 2.*B.^3.*N_y.*theta_x.*theta_y.*theta_z.^2 - 2.*B.^3.*N_y.*theta_x.^2.*theta_y.*theta_z + 2.*B.*C_m.^2.*N_x.*b.^2.*theta_y.^2 + 2.*B.*C_m.^2.*N_x.*b.^2.*theta_z.^2 + 2.*B.*C_m.^2.*N_y.*b.^2.*theta_y.^2 - 2.*C_m.^2.*N_x.*b.^2.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*C_m.^2.*N_x.*b.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*mu_x.^2.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*mu_x.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*mu_x.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*theta_x.*theta_y.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*theta_y.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*theta_y.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_m.*N_y.*b.*theta_y.^3 + 2.*C_m.^2.*C_u.*a.*b.^2.*theta_y - 2.*C_m.^2.*C_u.*a.*b.^2.*theta_z - 2.*B.^2.*C_u.*a.*mu_x.*theta_x.^2 + 2.*B.^2.*C_u.*a.*mu_x.^2.*theta_x + 2.*B.^2.*C_u.*a.*mu_x.*theta_z.^2 - 2.*B.^2.*C_u.*a.*mu_x.^2.*theta_z + 2.*B.^2.*C_d.*c.*lambda.*theta_x.^2 - 2.*B.*C_u.*a.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*C_u.*a.*theta_x.*theta_y.^2 - 2.*B.^2.*C_u.*a.*theta_x.^2.*theta_y - 2.*B.^2.*C_u.*a.*theta_x.*theta_z.^2 + 2.*B.^2.*C_u.*a.*theta_x.^2.*theta_z + 2.*B.^2.*C_u.*a.*theta_y.*theta_z.^2 - 2.*B.^2.*C_u.*a.*theta_y.^2.*theta_z - 2.*B.*C_u.*a.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_u.*a.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_u.*a.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_x + 2.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.^2 + 2.*B.^2.*C_m.*N_x.*b.*mu_x.^2.*theta_x + 2.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_y - 4.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*mu_x.^2.*theta_z - 2.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_x - 2.*B.*C_m.^2.*N_y.*b.^2.*mu_x.*theta_y - 4.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_y.^2 - 2.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_y + 2.*B.*C_m.^2.*N_y.*b.^2.*mu_x.*theta_z - 2.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_z.^2 + 4.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_z - 2.*B.*C_m.*N_x.*b.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_y.*b.*theta_y.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.*C_m.^2.*N_x.*b.^2.*theta_x.*theta_y + 2.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_y.^2 + 2.*B.^2.*C_m.*N_x.*b.*theta_x.^2.*theta_y - 4.*B.*C_m.^2.*N_x.*b.^2.*theta_x.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*theta_x.^2.*theta_z - 4.*B.*C_m.^2.*N_x.*b.^2.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*theta_y.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*theta_y.^2.*theta_z + 4.*B.^2.*C_m.*N_y.*b.*theta_x.*theta_y.^2 - 2.*B.*C_m.^2.*N_y.*b.^2.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_y.*b.*theta_y.*theta_z.^2 + 4.*B.^2.*N_y.*mu_x.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*mu_x.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 4.*B.^2.*N_y.*mu_x.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*theta_x.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*C_u.*a.*b.*theta_y.^2 + 2.*B.*C_m.*C_u.*a.*b.*theta_z.^2 - 2.*C_m.*C_u.*a.*b.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*C_m.*C_u.*a.*b.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_d.*c.*lambda.*mu_x.*theta_x + 2.*B.^2.*C_d.*c.*lambda.*mu_x.*theta_z - 2.*B.*C_u.*a.*mu_x.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_u.*a.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*C_u.*a.*mu_x.*theta_x.*theta_y - 4.*B.^2.*C_u.*a.*mu_x.*theta_y.*theta_z + 2.*B.*C_d.*c.*lambda.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_d.*c.*lambda.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_d.*c.*lambda.*theta_x.*theta_y - 2.*B.^2.*C_d.*c.*lambda.*theta_x.*theta_z + 2.*B.^2.*C_d.*c.*lambda.*theta_y.*theta_z - 2.*B.*C_m.*N_x.*b.*mu_x.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_x.*b.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_y.*b.*mu_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_y.*b.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.*theta_y - 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.*theta_z - 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_x.*theta_y + 4.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_y.*theta_z - 2.*B.*C_m.*N_x.*b.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_x.*b.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_x.*b.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_y.*b.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 4.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_y.*theta_z - 4.*B.^2.*C_m.*N_y.*b.*theta_x.*theta_y.*theta_z + 2.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_x + 2.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_y - 4.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_z + 2.*B.*C_d.*C_m.*b.*c.*lambda.*theta_x - 4.*B.*C_d.*C_m.*b.*c.*lambda.*theta_y + 2.*B.*C_d.*C_m.*b.*c.*lambda.*theta_z - 4.*B.*C_m.*C_u.*a.*b.*theta_y.*theta_z)./(2.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)).*(B.*theta_z.^2 + C_m.*b.*theta_y - C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)) - ((2.*B.*exp((t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*(C_u.*a.*B.^2.*mu_x.^2.*theta_x - C_u.*a.*B.^2.*mu_x.^2.*theta_z - C_u.*a.*B.^2.*mu_x.*theta_x.^2 + 2.*C_u.*a.*B.^2.*mu_x.*theta_x.*theta_y - C_d.*c.*lambda.*B.^2.*mu_x.*theta_x - 2.*C_u.*a.*B.^2.*mu_x.*theta_y.*theta_z + C_u.*a.*B.^2.*mu_x.*theta_z.^2 + C_d.*c.*lambda.*B.^2.*mu_x.*theta_z - C_u.*a.*B.^2.*theta_x.^2.*theta_y + C_u.*a.*B.^2.*theta_x.^2.*theta_z + C_d.*c.*lambda.*B.^2.*theta_x.^2 + C_u.*a.*B.^2.*theta_x.*theta_y.^2 - C_d.*c.*lambda.*B.^2.*theta_x.*theta_y - C_u.*a.*B.^2.*theta_x.*theta_z.^2 - C_d.*c.*lambda.*B.^2.*theta_x.*theta_z - C_u.*a.*B.^2.*theta_y.^2.*theta_z + C_u.*a.*B.^2.*theta_y.*theta_z.^2 + C_d.*c.*lambda.*B.^2.*theta_y.*theta_z + C_u.*a.*B.*C_m.*b.*mu_x.*theta_x + C_u.*a.*B.*C_m.*b.*mu_x.*theta_y - 2.*C_u.*a.*B.*C_m.*b.*mu_x.*theta_z + C_d.*c.*lambda.*B.*C_m.*b.*theta_x + C_u.*a.*B.*C_m.*b.*theta_y.^2 - 2.*C_u.*a.*B.*C_m.*b.*theta_y.*theta_z - 2.*C_d.*c.*lambda.*B.*C_m.*b.*theta_y + C_u.*a.*B.*C_m.*b.*theta_z.^2 + C_d.*c.*lambda.*B.*C_m.*b.*theta_z + C_u.*a.*C_m.^2.*b.^2.*theta_y - C_u.*a.*C_m.^2.*b.^2.*theta_z) - 2.*B.*exp((t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2).*(B.*C_u.*a.*theta_z.^2 + C_m.*C_u.*a.*b.*theta_y - C_m.*C_u.*a.*b.*theta_z + B.*C_u.*a.*mu_x.*theta_x - B.*C_u.*a.*mu_x.*theta_z - B.*C_d.*c.*lambda.*theta_x + B.*C_d.*c.*lambda.*theta_z + B.*C_u.*a.*theta_x.*theta_y - B.*C_u.*a.*theta_x.*theta_z - B.*C_u.*a.*theta_y.*theta_z)).*(B.*theta_z.^2 - C_m.*b.*theta_y + C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z))./(2.*B.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y - (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2).*(B.^2.*mu_x.^2.*theta_x.^2 - 2.*B.^2.*mu_x.^2.*theta_x.*theta_z + B.^2.*mu_x.^2.*theta_z.^2 + 2.*B.^2.*mu_x.*theta_x.^2.*theta_y - 2.*B.^2.*mu_x.*theta_x.^2.*theta_z - 4.*B.^2.*mu_x.*theta_x.*theta_y.*theta_z + 4.*B.^2.*mu_x.*theta_x.*theta_z.^2 + 2.*B.^2.*mu_x.*theta_y.*theta_z.^2 - 2.*B.^2.*mu_x.*theta_z.^3 + B.^2.*theta_x.^2.*theta_y.^2 - 2.*B.^2.*theta_x.^2.*theta_y.*theta_z + B.^2.*theta_x.^2.*theta_z.^2 - 2.*B.^2.*theta_x.*theta_y.^2.*theta_z + 4.*B.^2.*theta_x.*theta_y.*theta_z.^2 - 2.*B.^2.*theta_x.*theta_z.^3 + B.^2.*theta_y.^2.*theta_z.^2 - 2.*B.^2.*theta_y.*theta_z.^3 + B.^2.*theta_z.^4 - C_m.^2.*b.^2.*theta_y.^2 + 2.*C_m.^2.*b.^2.*theta_y.*theta_z - C_m.^2.*b.^2.*theta_z.^2))) - exp(-(t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*((2.*C_m.^3.*N_x.*b.^3.*theta_y - 2.*C_m.^3.*N_x.*b.^3.*theta_z - 2.*B.^3.*N_y.*mu_x.^3.*theta_x + 2.*B.^3.*N_y.*mu_x.^3.*theta_z - 2.*B.^3.*N_y.*theta_x.*theta_y.^3 + 2.*B.^3.*N_y.*theta_y.^3.*theta_z + 2.*B.^3.*N_y.*mu_x.^2.*theta_x.^2 - 2.*B.^3.*N_y.*mu_x.^2.*theta_z.^2 + 2.*B.^3.*N_y.*theta_x.^2.*theta_y.^2 - 2.*B.^3.*N_y.*theta_y.^2.*theta_z.^2 - 6.*B.^3.*N_y.*mu_x.*theta_x.*theta_y.^2 + 4.*B.^3.*N_y.*mu_x.*theta_x.^2.*theta_y - 6.*B.^3.*N_y.*mu_x.^2.*theta_x.*theta_y + 2.*B.^3.*N_y.*mu_x.*theta_x.*theta_z.^2 - 2.*B.^3.*N_y.*mu_x.*theta_x.^2.*theta_z - 4.*B.^3.*N_y.*mu_x.*theta_y.*theta_z.^2 + 6.*B.^3.*N_y.*mu_x.*theta_y.^2.*theta_z + 6.*B.^3.*N_y.*mu_x.^2.*theta_y.*theta_z + 2.*B.^3.*N_y.*theta_x.*theta_y.*theta_z.^2 - 2.*B.^3.*N_y.*theta_x.^2.*theta_y.*theta_z + 2.*B.*C_m.^2.*N_x.*b.^2.*theta_y.^2 + 2.*B.*C_m.^2.*N_x.*b.^2.*theta_z.^2 + 2.*B.*C_m.^2.*N_y.*b.^2.*theta_y.^2 + 2.*C_m.^2.*N_x.*b.^2.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*C_m.^2.*N_x.*b.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*mu_x.^2.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*mu_x.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*mu_x.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*theta_x.*theta_y.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*N_y.*theta_y.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*theta_y.^2.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_m.*N_y.*b.*theta_y.^3 + 2.*C_m.^2.*C_u.*a.*b.^2.*theta_y - 2.*C_m.^2.*C_u.*a.*b.^2.*theta_z - 2.*B.^2.*C_u.*a.*mu_x.*theta_x.^2 + 2.*B.^2.*C_u.*a.*mu_x.^2.*theta_x + 2.*B.^2.*C_u.*a.*mu_x.*theta_z.^2 - 2.*B.^2.*C_u.*a.*mu_x.^2.*theta_z + 2.*B.^2.*C_d.*c.*lambda.*theta_x.^2 + 2.*B.*C_u.*a.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*C_u.*a.*theta_x.*theta_y.^2 - 2.*B.^2.*C_u.*a.*theta_x.^2.*theta_y - 2.*B.^2.*C_u.*a.*theta_x.*theta_z.^2 + 2.*B.^2.*C_u.*a.*theta_x.^2.*theta_z + 2.*B.^2.*C_u.*a.*theta_y.*theta_z.^2 - 2.*B.^2.*C_u.*a.*theta_y.^2.*theta_z + 2.*B.*C_u.*a.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_u.*a.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_u.*a.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_x + 2.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.^2 + 2.*B.^2.*C_m.*N_x.*b.*mu_x.^2.*theta_x + 2.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_y - 4.*B.*C_m.^2.*N_x.*b.^2.*mu_x.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*mu_x.^2.*theta_z - 2.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_x - 2.*B.*C_m.^2.*N_y.*b.^2.*mu_x.*theta_y - 4.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_y.^2 - 2.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_y + 2.*B.*C_m.^2.*N_y.*b.^2.*mu_x.*theta_z - 2.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_z.^2 + 4.*B.^2.*C_m.*N_y.*b.*mu_x.^2.*theta_z + 2.*B.*C_m.*N_x.*b.*theta_z.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_y.*b.*theta_y.^2.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.*C_m.^2.*N_x.*b.^2.*theta_x.*theta_y + 2.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_y.^2 + 2.*B.^2.*C_m.*N_x.*b.*theta_x.^2.*theta_y - 4.*B.*C_m.^2.*N_x.*b.^2.*theta_x.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*theta_x.^2.*theta_z - 4.*B.*C_m.^2.*N_x.*b.^2.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_x.*b.*theta_y.*theta_z.^2 - 2.*B.^2.*C_m.*N_x.*b.*theta_y.^2.*theta_z + 4.*B.^2.*C_m.*N_y.*b.*theta_x.*theta_y.^2 - 2.*B.*C_m.^2.*N_y.*b.^2.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_y.*b.*theta_y.*theta_z.^2 - 4.*B.^2.*N_y.*mu_x.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*mu_x.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*N_y.*mu_x.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.^2.*N_y.*theta_x.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*C_u.*a.*b.*theta_y.^2 + 2.*B.*C_m.*C_u.*a.*b.*theta_z.^2 + 2.*C_m.*C_u.*a.*b.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*C_m.*C_u.*a.*b.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_d.*c.*lambda.*mu_x.*theta_x + 2.*B.^2.*C_d.*c.*lambda.*mu_x.*theta_z + 2.*B.*C_u.*a.*mu_x.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_u.*a.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*C_u.*a.*mu_x.*theta_x.*theta_y - 4.*B.^2.*C_u.*a.*mu_x.*theta_y.*theta_z - 2.*B.*C_d.*c.*lambda.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_d.*c.*lambda.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.^2.*C_d.*c.*lambda.*theta_x.*theta_y - 2.*B.^2.*C_d.*c.*lambda.*theta_x.*theta_z + 2.*B.^2.*C_d.*c.*lambda.*theta_y.*theta_z + 2.*B.*C_m.*N_x.*b.*mu_x.*theta_x.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_x.*b.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_y.*b.*mu_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_y.*b.*mu_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.*theta_y - 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_x.*theta_z - 4.*B.^2.*C_m.*N_x.*b.*mu_x.*theta_y.*theta_z + 2.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_x.*theta_y + 4.*B.^2.*C_m.*N_y.*b.*mu_x.*theta_y.*theta_z + 2.*B.*C_m.*N_x.*b.*theta_x.*theta_y.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_x.*b.*theta_x.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 2.*B.*C_m.*N_x.*b.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) + 2.*B.*C_m.*N_y.*b.*theta_y.*theta_z.*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2) - 4.*B.^2.*C_m.*N_x.*b.*theta_x.*theta_y.*theta_z - 4.*B.^2.*C_m.*N_y.*b.*theta_x.*theta_y.*theta_z + 2.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_x + 2.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_y - 4.*B.*C_m.*C_u.*a.*b.*mu_x.*theta_z + 2.*B.*C_d.*C_m.*b.*c.*lambda.*theta_x - 4.*B.*C_d.*C_m.*b.*c.*lambda.*theta_y + 2.*B.*C_d.*C_m.*b.*c.*lambda.*theta_z - 4.*B.*C_m.*C_u.*a.*b.*theta_y.*theta_z)./(2.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)).*(B.*theta_z.^2 + C_m.*b.*theta_y - C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)) - ((2.*B.*exp((t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*(C_u.*a.*B.^2.*mu_x.^2.*theta_x - C_u.*a.*B.^2.*mu_x.^2.*theta_z - C_u.*a.*B.^2.*mu_x.*theta_x.^2 + 2.*C_u.*a.*B.^2.*mu_x.*theta_x.*theta_y - C_d.*c.*lambda.*B.^2.*mu_x.*theta_x - 2.*C_u.*a.*B.^2.*mu_x.*theta_y.*theta_z + C_u.*a.*B.^2.*mu_x.*theta_z.^2 + C_d.*c.*lambda.*B.^2.*mu_x.*theta_z - C_u.*a.*B.^2.*theta_x.^2.*theta_y + C_u.*a.*B.^2.*theta_x.^2.*theta_z + C_d.*c.*lambda.*B.^2.*theta_x.^2 + C_u.*a.*B.^2.*theta_x.*theta_y.^2 - C_d.*c.*lambda.*B.^2.*theta_x.*theta_y - C_u.*a.*B.^2.*theta_x.*theta_z.^2 - C_d.*c.*lambda.*B.^2.*theta_x.*theta_z - C_u.*a.*B.^2.*theta_y.^2.*theta_z + C_u.*a.*B.^2.*theta_y.*theta_z.^2 + C_d.*c.*lambda.*B.^2.*theta_y.*theta_z + C_u.*a.*B.*C_m.*b.*mu_x.*theta_x + C_u.*a.*B.*C_m.*b.*mu_x.*theta_y - 2.*C_u.*a.*B.*C_m.*b.*mu_x.*theta_z + C_d.*c.*lambda.*B.*C_m.*b.*theta_x + C_u.*a.*B.*C_m.*b.*theta_y.^2 - 2.*C_u.*a.*B.*C_m.*b.*theta_y.*theta_z - 2.*C_d.*c.*lambda.*B.*C_m.*b.*theta_y + C_u.*a.*B.*C_m.*b.*theta_z.^2 + C_d.*c.*lambda.*B.*C_m.*b.*theta_z + C_u.*a.*C_m.^2.*b.^2.*theta_y - C_u.*a.*C_m.^2.*b.^2.*theta_z) + 2.*B.*exp((t.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)))./(2.*B)).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2).*(B.*C_u.*a.*theta_z.^2 + C_m.*C_u.*a.*b.*theta_y - C_m.*C_u.*a.*b.*theta_z + B.*C_u.*a.*mu_x.*theta_x - B.*C_u.*a.*mu_x.*theta_z - B.*C_d.*c.*lambda.*theta_x + B.*C_d.*c.*lambda.*theta_z + B.*C_u.*a.*theta_x.*theta_y - B.*C_u.*a.*theta_x.*theta_z - B.*C_u.*a.*theta_y.*theta_z)).*(B.*theta_z.^2 - C_m.*b.*theta_y + C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z))./(2.*B.*(C_m.*b + B.*mu_x + B.*theta_x + B.*theta_y + (B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2)).*(B.^2.*mu_x.^2 - 2.*B.^2.*mu_x.*theta_x + 2.*B.^2.*mu_x.*theta_y + B.^2.*theta_x.^2 - 2.*B.^2.*theta_x.*theta_y + B.^2.*theta_y.^2 + 2.*B.*C_m.*b.*mu_x + 2.*B.*C_m.*b.*theta_x - 2.*B.*C_m.*b.*theta_y + C_m.^2.*b.^2).^(1./2).*(B.^2.*mu_x.^2.*theta_x.^2 - 2.*B.^2.*mu_x.^2.*theta_x.*theta_z + B.^2.*mu_x.^2.*theta_z.^2 + 2.*B.^2.*mu_x.*theta_x.^2.*theta_y - 2.*B.^2.*mu_x.*theta_x.^2.*theta_z - 4.*B.^2.*mu_x.*theta_x.*theta_y.*theta_z + 4.*B.^2.*mu_x.*theta_x.*theta_z.^2 + 2.*B.^2.*mu_x.*theta_y.*theta_z.^2 - 2.*B.^2.*mu_x.*theta_z.^3 + B.^2.*theta_x.^2.*theta_y.^2 - 2.*B.^2.*theta_x.^2.*theta_y.*theta_z + B.^2.*theta_x.^2.*theta_z.^2 - 2.*B.^2.*theta_x.*theta_y.^2.*theta_z + 4.*B.^2.*theta_x.*theta_y.*theta_z.^2 - 2.*B.^2.*theta_x.*theta_z.^3 + B.^2.*theta_y.^2.*theta_z.^2 - 2.*B.^2.*theta_y.*theta_z.^3 + B.^2.*theta_z.^4 - C_m.^2.*b.^2.*theta_y.^2 + 2.*C_m.^2.*b.^2.*theta_y.*theta_z - C_m.^2.*b.^2.*theta_z.^2))) + (C_d.*c.*lambda.*exp(-t.*theta_z).*(exp(t.*theta_z) - 1).*(theta_x - theta_z))./(theta_z.*(B.*theta_z.^2 + C_m.*b.*theta_y - C_m.*b.*theta_z + B.*mu_x.*theta_x - B.*mu_x.*theta_z + B.*theta_x.*theta_y - B.*theta_x.*theta_z - B.*theta_y.*theta_z))));
    z=(real((lambda - lambda.*exp(-t.*theta_z))./theta_z));
end

%% Closed-form solution (A)
A =(real((- a.*C_u./B -(c.*C_d.*(lambda - lambda.*exp(-t.*theta_z))./(theta_z.*B))).*theta_y./(b.*theta_y.*C_m./B  + theta_x.*theta_y + theta_x.*mu_x)));
D=abs(real(1./B.^2.*(b.^2.*C_m.^2+2.*b.*B.*C_m.*(theta_x - theta_y + mu_x)+ B.^2.*(theta_x.^2-2.*theta_x.*(mu_x +theta_y)+mu_x.^2 +2.*mu_x.*theta_y+theta_y.^2))));

X1= (real(1/2.*(-b.*C_m./B -theta_x -theta_y - mu_x + sqrt(D))));
X2= (real(1/2.*(-b.*C_m./B -theta_x -theta_y - mu_x - sqrt(D))));

C2=(real(1./(X1  - X2).*(X1.* N_x - X1.* (- a).*C_u./B .*theta_y./( b.*theta_y.*C_m./B  + theta_x.*theta_y +theta_x.*mu_x ) + a.*C_u./B + b.*C_m./B.*N_x + theta_x.*N_x- N_y .*mu_x)));
C1=(real(N_x -C2 -((-a).*C_u./B.*theta_y)./( b.*theta_y.*C_m./B  + theta_x.*theta_y +theta_x.*mu_x)));

x_=(real( C1.*exp(t.*X1) +C2.*exp(t.*X2) + A));
y_=(real(1./mu_x.*(X1.*C1.*exp(t.*X1)+X2.*C2.*exp(t.*X2)+a.*C_u./B + theta_x.*(C1.*exp(t.*X1)+C2.*exp(t.*X2)+A)+b.*C_m./B.*(C1.*exp(t.*X1)+C2.*exp(t.*X2)+A)+ c.*C_d./B.* (((lambda-lambda.*exp(-theta_z.*t))./theta_z)))));
z_=(real((lambda - lambda.*exp(-t.*theta_z))./theta_z));

%% Plot
figure;
plot(t,x,':','Color',[255/255 128/255 0/255],'LineWidth',1);
hold on
plot(t,y,':','Color',[9/255 185/255 80/255],'LineWidth',1);
hold on
plot(t,z,':','Color',[77/255 139/255 210/255],'LineWidth',1);
hold on
plot(t,x_,'--','Color',[255/255 128/255 0/255],'LineWidth',1);
hold on
plot(t,y_,'--','Color',[9/255 185/255 80/255],'LineWidth',1);
hold on
plot(t,z_,'--','Color',[77/255 139/255 210/255],'LineWidth',1);
hold on
ylim([0 30])
xlim([0 5])
xlabel('Time, s')
ylabel('Number of users')
legend('V:Waiting users','V:Served users','V:Search & rescue operators','A:Waiting users','A:Served users','A:Search & rescue operators')
grid on
